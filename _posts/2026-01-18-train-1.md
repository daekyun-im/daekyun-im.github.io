---
layout: single
title: "2026 01 18 Train 1"
categories: coding
tag: ['python', 'jupyter']
toc: true
author_profile: false
---

# ✅ 문제 (2026-01-18)

## 1️⃣ 샘플 단위 피처 집계



sample 단위로 아래 피처를 계산한 df_feat를 만들어라.



| sample | temp_mean | ph_min | titer_last |



정의:



temp_mean: temp 평균



ph_min: ph 최솟값



titer_last: minute가 가장 큰 행의 titer 값 (즉 마지막 titer)



### ⚠️ 조건



for / while ❌



정렬을 이용해 “마지막 값”을 가져와도 됨



## 2️⃣ 라벨 생성



df_feat에 아래 라벨 컬럼을 추가하라.



is_low_titer:



titer_last < 2.2 이면 True



아니면 False



## 3️⃣ 룰 기반 예측 및 평가



아래 룰로 예측값 pred_low를 만들고, 혼동행렬용 집계를 만들어라.



pred_low:



ph_min < 6.9 이면 True



아니면 False



아래 4개 숫자를 계산해 변수에 저장하라.



TP: is_low_titer=True & pred_low=True 개수



FP: is_low_titer=False & pred_low=True 개수



TN: is_low_titer=False & pred_low=False 개수



FN: is_low_titer=True & pred_low=False 개수



### ⚠️ 조건



for / while ❌



## 4️⃣ 시각화 (조건 엄수)

Scatter plot: ph_min vs titer_last



figure size: (7, 4)



x축: ph_min



y축: titer_last



marker: 'o'



색상:



is_low_titer == True → red



그 외 → gray



title: "ph_min vs titer_last (Low Titer Highlight)"



xlabel: "ph_min"



ylabel: "titer_last"



grid: 표시 ❌



legend: 표시 ❌



추가 요구:



x = 6.9 위치에 회색 점선 수직선



linestyle "--"



linewidth 2



## ❗ 제출물



df_feat



TP, FP, TN, FN



plot 코드

# 데이터

```python
import pandas as pd

df = pd.DataFrame({
    "sample": ["S1","S1","S1","S2","S2","S2","S3","S3","S3","S4","S4","S4"],
    "minute": [0, 1, 2, 0, 1, 2, 0, 1, 2, 0, 1, 2],
    "temp":   [37.0, 37.5, 37.0, 37.0, 36.5, 36.0, 36.5, 36.5, 36.5, 37.0, 37.0, 37.0],
    "ph":     [7.10, 7.05, 7.00, 7.00, 6.95, 6.90, 6.85, 6.80, 6.75, 7.10, 7.10, 7.10],
    "titer":  [2.5,  2.6,  2.4,  2.2,  2.1,  2.0,  1.8,  1.7,  1.6,  2.9,  2.9,  2.9],
})
display(df)
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample</th>
      <th>minute</th>
      <th>temp</th>
      <th>ph</th>
      <th>titer</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>S1</td>
      <td>0</td>
      <td>37.0</td>
      <td>7.10</td>
      <td>2.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>S1</td>
      <td>1</td>
      <td>37.5</td>
      <td>7.05</td>
      <td>2.6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>S1</td>
      <td>2</td>
      <td>37.0</td>
      <td>7.00</td>
      <td>2.4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>S2</td>
      <td>0</td>
      <td>37.0</td>
      <td>7.00</td>
      <td>2.2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>S2</td>
      <td>1</td>
      <td>36.5</td>
      <td>6.95</td>
      <td>2.1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>S2</td>
      <td>2</td>
      <td>36.0</td>
      <td>6.90</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>S3</td>
      <td>0</td>
      <td>36.5</td>
      <td>6.85</td>
      <td>1.8</td>
    </tr>
    <tr>
      <th>7</th>
      <td>S3</td>
      <td>1</td>
      <td>36.5</td>
      <td>6.80</td>
      <td>1.7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>S3</td>
      <td>2</td>
      <td>36.5</td>
      <td>6.75</td>
      <td>1.6</td>
    </tr>
    <tr>
      <th>9</th>
      <td>S4</td>
      <td>0</td>
      <td>37.0</td>
      <td>7.10</td>
      <td>2.9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>S4</td>
      <td>1</td>
      <td>37.0</td>
      <td>7.10</td>
      <td>2.9</td>
    </tr>
    <tr>
      <th>11</th>
      <td>S4</td>
      <td>2</td>
      <td>37.0</td>
      <td>7.10</td>
      <td>2.9</td>
    </tr>
  </tbody>
</table>
</div>

# 풀이

```python
df_feat = df.groupby('sample').agg(
    temp_mean = ('temp','mean'),
    ph_min = ('ph', 'min'),
    titer_last = ('titer', lambda x: df.loc[df.loc[x.index, 'minute'].idxmax()]['titer'])
)
display(df_feat)
df_feat['is_low_titer']=df_feat['titer_last']<2.2
display(df_feat)
pred_low = df_feat['ph_min']<6.9
display(pred_low)
TP = sum((df_feat['is_low_titer']) & (pred_low))
FP = sum((~df_feat['is_low_titer']) & (pred_low))
TN = sum((~df_feat['is_low_titer']) & (~pred_low))
FN = sum((df_feat['is_low_titer']) & (~pred_low))
display(TP, FP, TN, FN)
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>temp_mean</th>
      <th>ph_min</th>
      <th>titer_last</th>
    </tr>
    <tr>
      <th>sample</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>S1</th>
      <td>37.166667</td>
      <td>7.00</td>
      <td>2.4</td>
    </tr>
    <tr>
      <th>S2</th>
      <td>36.500000</td>
      <td>6.90</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>S3</th>
      <td>36.500000</td>
      <td>6.75</td>
      <td>1.6</td>
    </tr>
    <tr>
      <th>S4</th>
      <td>37.000000</td>
      <td>7.10</td>
      <td>2.9</td>
    </tr>
  </tbody>
</table>
</div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>temp_mean</th>
      <th>ph_min</th>
      <th>titer_last</th>
      <th>is_low_titer</th>
    </tr>
    <tr>
      <th>sample</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>S1</th>
      <td>37.166667</td>
      <td>7.00</td>
      <td>2.4</td>
      <td>False</td>
    </tr>
    <tr>
      <th>S2</th>
      <td>36.500000</td>
      <td>6.90</td>
      <td>2.0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>S3</th>
      <td>36.500000</td>
      <td>6.75</td>
      <td>1.6</td>
      <td>True</td>
    </tr>
    <tr>
      <th>S4</th>
      <td>37.000000</td>
      <td>7.10</td>
      <td>2.9</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>

```
sample
S1    False
S2    False
S3     True
S4    False
Name: ph_min, dtype: bool
```

```
1
```

```
0
```

```
2
```

```
1
```

```python
import numpy as np
import matplotlib.pyplot as plt
fig, ax = plt.subplots(figsize=(7,4))
color = np.where(df_feat['is_low_titer']==True, ')
ax.scatter(df_feat['ph_min'], df_feat['titer_last'], marker = 'o', color = )
```
